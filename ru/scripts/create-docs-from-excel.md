---
title: Создать документы для каждой записи из Excel
desc: Команда создаёт документы из шаблонов для каждой строки в XLSX файле.
---
# Создать документы из Excel

Команда **Создать документы из Excel** создаёт документы из шаблонов для каждого ряда в указанном XLSX файле. Шаблоны документов могут быть DOCX, ODS, ODT, XLSX файлами.

%html.create-docs-from-excel%

**Имя файла**  
Укажите полный или относительный путь к XLSX файлу, в котором вы хотите прочитать каждый ряд и создать для него документы. По умолчанию, скрипт перебирает ряды в первом листе.

**Имя переменной**  
Укажите имя переменной, в которую будет записан массив значений очередного ряда. Нумерация начинается с нуля. Вы можете использовать эту переменную объект в шаблонах документов. Например, если вы указали имя переменной *usr*, то значение *#usr[0]#* будет равно значению ячейки в текущем ряде в колонке *A*. *#usr[1]#* будет равно значению в колонке *B* и т.д.

**Колонки**  
По умолчанию, поля каждой строки записываются в переменную массив. Но вы можете указать имя для каждой колонки. Имена разделяются запятыми. В этом случае, значения колонок будут записаны в ассоциативный массив. Если вы не укажете имя для колонки, то она не будет доступна. Например, пусть у нас указана переменная *usr* и значение этого параметра равно *id,name,company*. В этом случае, *#usr.id#* равно значению в колонке *A*, *#usr.name#* равно значению в колонке *B*, *#usr.company#* равно значению в колонке *C*. Если в этом параметре указать *id,name,*, то будут определены только значения *#usr.name#* и *#usr.id#*.

**Директория вывода**  
Укажите директорию, где будут сохраняться созданные документы. Если папки не существует, то она будет создана автоматически.

## Шаблоны

Можно указать один или несколько шаблонов документов, в которых будут заменены значения переменных и созданы документы для каждой записи в Excel файле.

**Шаблон документа**  
Укажите файл шаблона документа, в котором необходимо заменить переменные и сохранить в директорию вывода. Можно указывать шаблоны с расширениями DOCX, XLSX, ODT, ODS. Если в качестве шаблона указаны электронные таблицы XLSX или ODS, то замена переменных будет происходить на всех листах.

**Шаблон имени файла**  
Укажите шаблон для имени документа без расширения. Здесь, в том числе, можно указывать значения из таблицы Excel. Например, пусть имя переменной для получения значения равно *usr* и определен столбец с именем *name*. В этом случае, если вы укажете здесь *#usr.name#*, то имя содаваемого документа будет равно имени пользователя (John Doe.docx). Если этот параметр не указан, то все документы будут сохранятся с таким же именем, как имя шаблона документа. Следует заметить, что в этом случае, а также когда документ с таким же именем уже существует, то к имени файла будет добавлен суффикс - *pattern (1).docx*, *pattern (2).docx* и т.д. Таким образом, в любом случае, будут созданы все документы для всех рядов в Excel файле.
